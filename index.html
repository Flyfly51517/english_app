<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Unit 5 & 6 å–®å­—å¤§æŒ‘æˆ° (å¯æ„›ç‰ˆ)</title>
<style>
    /* å…¨åŸŸè¨­å®š */
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    :root { 
        --primary: #FF9A9E;    /* å¯æ„›ç²‰ç´… */
        --secondary: #FECFEF;  /* æ·ºç²‰ */
        --accent: #a18cd1;     /* å¤¢å¹»ç´« */
        --text: #555;
        --btn-line: #06C755;
        --btn-wrong: #FF9F43;  /* éŒ¯é¡ŒæŒ‰éˆ•æ©˜è‰² */
    }
    
    body { 
        font-family: "Miku", "å¾®è»Ÿæ­£é»‘é«”", sans-serif; /* å˜—è©¦ç”¨å¯æ„›å­—é«”ï¼Œè‹¥ç„¡å‰‡å›é€€ */
        /* å¤¢å¹»æ¼¸å±¤èƒŒæ™¯ */
        background: linear-gradient(120deg, #a18cd1 0%, #fbc2eb 100%);
        min-height: 100vh;
        margin: 0; 
        padding: 20px 15px; 
        color: var(--text); 
    }

    .container { 
        max-width: 600px; 
        margin: 0 auto; 
        background: rgba(255, 255, 255, 0.95); /* åŠé€æ˜ç™½åº• */
        padding: 25px; 
        border-radius: 25px; 
        box-shadow: 0 10px 25px rgba(0,0,0,0.1); 
        position: relative;
        overflow: hidden;
    }
    
    /* æ¨™é¡Œå€ */
    header { text-align: center; margin-bottom: 25px; border-bottom: 2px dashed #ffe0e6; padding-bottom: 15px; }
    h1 { 
        color: #ff6b81; 
        margin: 0; 
        font-size: 1.6rem; 
        text-shadow: 1px 1px 0px #fff;
    }
    p.subtitle { color: #888; font-size: 0.9rem; margin-top: 8px; }

    /* é¡Œç›®å¡ç‰‡ */
    .page { display: none; }
    .page.active { display: block; animation: popUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    @keyframes popUp { from { opacity: 0; transform: scale(0.95) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }

    .question-card { 
        background: #fff; 
        border: 2px solid #fff0f3; 
        border-radius: 18px; 
        padding: 20px; 
        margin-bottom: 20px; 
        box-shadow: 0 4px 12px rgba(255, 154, 158, 0.15);
    }
    .q-type { 
        display: inline-block;
        background: #e0c3fc;
        color: white;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 0.75rem; 
        font-weight: bold; 
        margin-bottom: 10px; 
    }
    .q-text { font-weight: 700; font-size: 1.2em; margin-bottom: 15px; display: block; line-height: 1.5; color: #444; }
    
    /* é¸é …æ¨£å¼ - å¯æ„›åœ“è§’ */
    label { 
        display: flex; 
        align-items: center; 
        padding: 12px 15px; 
        margin: 10px 0; 
        cursor: pointer; 
        border-radius: 15px; 
        background: #f8f9fa; 
        border: 2px solid transparent; 
        transition: 0.2s; 
        font-size: 0.95rem;
        box-shadow: 0 2px 5px rgba(0,0,0,0.03);
    }
    label:hover { background: #fff0f5; border-color: #ffc3a0; }
    input[type="radio"] { margin-right: 12px; transform: scale(1.2); accent-color: #ff6b81; }

    /* æŒ‰éˆ•å€ */
    .nav-buttons { display: flex; gap: 15px; margin-top: 25px; }
    .btn { 
        flex: 1; 
        padding: 15px; 
        font-size: 1.1rem; 
        border: none; 
        border-radius: 50px; /* åœ“åœ“çš„æŒ‰éˆ• */
        cursor: pointer; 
        color: white; 
        font-weight: bold; 
        text-align: center;
        transition: transform 0.1s, box-shadow 0.2s;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .btn:active { transform: scale(0.95); }
    .btn-next { background: linear-gradient(to right, #ff9a9e, #fad0c4); }
    .btn-submit { background: linear-gradient(to right, #a18cd1, #fbc2eb); display: none; } 
    
    /* çµæœé  */
    .correct { background-color: #d4edda !important; border-color: #c3e6cb !important; color: #155724; }
    .wrong { background-color: #ffe5e5 !important; border-color: #ffcccc !important; color: #d63031; }
    .answer-key { font-weight: bold; color: #ff6b81; margin-top: 10px; display: none; padding: 10px; background: #fff0f3; border-radius: 10px; }

    #result-area { 
        text-align: center; 
        margin-top: 20px; 
        padding: 30px 20px; 
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        display: none; 
    }
    #score-text { font-size: 4em; font-weight: 800; color: #a18cd1; margin: 10px 0; text-shadow: 2px 2px 0px #eee; }
    #comment { font-size: 1.2em; font-weight: bold; color: #666; margin-bottom: 5px; }
    
    /* åŠŸèƒ½æŒ‰éˆ• */
    .btn-group-vertical { display: flex; flex-direction: column; gap: 12px; margin-top: 20px; }
    
    .btn-line { 
        background-color: var(--btn-line); 
        text-decoration: none; 
        display: flex; align-items: center; justify-content: center; 
        padding: 15px; border-radius: 15px; color: white; font-weight: bold; 
    }
    
    .btn-wrong-list {
        background-color: var(--btn-wrong);
        text-decoration: none;
        display: flex; align-items: center; justify-content: center;
        padding: 15px; border-radius: 15px; color: white; font-weight: bold;
    }

    .btn-retry { 
        background-color: #dfe6e9; color: #636e72; 
        border-radius: 15px; padding: 15px; width: 100%; border:none; font-weight:bold; cursor: pointer;
    }

    /* é€²åº¦æ¢ */
    .progress-container { background-color: #f0f0f0; border-radius: 20px; height: 10px; margin-bottom: 15px; overflow: hidden; }
    .progress-bar { background: linear-gradient(to right, #ff9a9e, #fecfef); height: 100%; width: 0%; transition: width 0.4s; }
    .info-bar { display: flex; justify-content: space-between; color: #aaa; font-size: 0.85rem; margin-bottom: 20px; font-weight: bold; }

</style>
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸŒŸ Unit 5 & 6 å–®å­—æŒ‘æˆ° ğŸŒŸ</h1>
        <p class="subtitle">åŠ æ²¹ï¼å…¨éƒ¨ç­”å°å°±æ˜¯å–®å­—ç‹ï¼</p>
        <p style="color: #ff6b81; font-size: 0.8rem; margin-top:5px; font-weight: bold;">âš ï¸ å¯«å®Œé€™é æ‰èƒ½å»ä¸‹ä¸€é å–”ï¼</p>
    </header>

    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="info-bar">
        <span id="qCount">Ready? Go!</span>
        <span id="pageIndicator">Page 1</span>
    </div>

    <form id="quizForm">
        <div id="quiz-pages"></div>
        
        <div class="nav-buttons">
            <button type="button" class="btn btn-next" id="btnNext" onclick="nextPage()">ä¸‹ä¸€é  â¡</button>
            <button type="button" class="btn btn-submit" id="btnSubmit" onclick="submitQuiz()">äº¤å·çœ‹æˆç¸¾ âœ¨</button>
        </div>
    </form>

    <div id="result-area">
        <h2 style="margin:0; color:#888;">æœ¬æ¬¡æˆç¸¾</h2>
        <div id="score-text">0</div>
        <p id="comment"></p>
        <p id="date-display" style="color:#aaa; font-size:0.8rem; margin-bottom:20px;"></p>
        
        <div class="btn-group-vertical">
            <a id="line-share-btn" class="btn btn-line" target="_blank">
                ğŸ“ ç¹³äº¤æˆç¸¾çµ¦è€å¸« (Line)
            </a>

            <a id="wrong-share-btn" class="btn btn-wrong-list" target="_blank" style="display:none;">
                ğŸŠ è¼¸å‡ºéŒ¯èª¤é¡Œç›® (Line)
            </a>
            
            <button class="btn btn-retry" onclick="location.reload()">ğŸ”„ é‡æ–°æ•´ç†å†è€ƒä¸€æ¬¡</button>
        </div>
    </div>
</div>

<script>
    /* =====================================================
       æ ¸å¿ƒå–®å­—è³‡æ–™åº« (Unit 5 + Unit 6)
       ===================================================== */
    const rawData = [
        // Unit 5
        { w: "public", c: "å…¬çœ¾(çš„)", s: "This is a ______ park." },
        { w: "play", c: "æ‰®æ¼”", s: "He will ______ the king." },
        { w: "uniform", c: "åˆ¶æœ", s: "Wear your school ______." },
        { w: "bottom", c: "è‡€éƒ¨ï¼›åº•éƒ¨", s: "At the ______ of the page." },
        { w: "tail", c: "å°¾å·´", s: "The dog has a short ______." },
        { w: "pin", c: "é£¾é‡ï¼›èƒ¸é‡", s: "A lovely ______ on the coat." },
        { w: "bow", c: "è´è¶çµ", s: "She wears a ______." },
        { w: "dot", c: "åœ“é»", s: "A dress with polka ______s." },
        { w: "round", c: "åœ“å½¢çš„", s: "The ball is ______." },
        { w: "square", c: "æ­£æ–¹å½¢(çš„)", s: "A ______ box." },
        { w: "string", c: "ä¸²ï¼›ç·š", s: "Tie with a ______." },
        { w: "line", c: "éšŠä¼ï¼›ç›´ç·š", s: "Stand in a ______." },
        { w: "arrive", c: "æŠµé”", s: "We will ______ soon." },
        { w: "appear", c: "å‡ºç¾", s: "Stars ______ at night." },
        { w: "notice", c: "æ³¨æ„åˆ°", s: "Did you ______ him?" },
        { w: "lead", c: "é€šå¾€", s: "Roads ______ to Rome." },
        { w: "restroom", c: "æ´—æ‰‹é–“", s: "Go to the ______." },
        { w: "bath", c: "æ²æµ´", s: "Take a hot ______." },
        { w: "neighbor", c: "é„°å±…", s: "My ______ is kind." },
        { w: "foreigner", c: "å¤–åœ‹äºº", s: "He is a ______." },
        { w: "business", c: "ç”Ÿæ„", s: "Do ______ with them." },
        { w: "businessman", c: "å•†äºº", s: "He is a rich ______." },
        { w: "workbook", c: "ä½œæ¥­æœ¬", s: "Open your ______." },
        { w: "exercise", c: "ç·´ç¿’", s: "Do some math ______." },
        { w: "hobby", c: "å—œå¥½", s: "My ______ is reading." },
        { w: "born", c: "å‡ºç”Ÿçš„", s: "I was ______ in 2010." },
        { w: "light", c: "è¼•çš„", s: "This bag is ______." },
        { w: "prize", c: "ç", s: "Win a big ______." },
        { w: "main", c: "ä¸»è¦çš„", s: "The ______ idea." },
        { w: "topic", c: "ä¸»é¡Œ", s: "Today's ______." },
        { w: "belong", c: "å±¬æ–¼", s: "It ______s to me." },
        { w: "key", c: "é—œéµ(çš„)", s: "The ______ to success." },
        { w: "knowledge", c: "çŸ¥è­˜", s: "Books give ______." },
        { w: "dictionary", c: "å­—å…¸", s: "Use a ______." },
        { w: "planet", c: "è¡Œæ˜Ÿ", s: "Earth is a ______." },
        { w: "go on", c: "ç™¼ç”Ÿ", s: "What is ______ing ______?" },
        { w: "be no stranger to", c: "å°...ä¸é™Œç”Ÿ", s: "He ______ hard work." },
        // Unit 6
        { w: "town", c: "åŸé®", s: "A small ______." },
        { w: "visitor", c: "éŠå®¢", s: "Many ______s came." },
        { w: "invite", c: "é‚€è«‹", s: "I will ______ you." },
        { w: "apartment", c: "å…¬å¯“", s: "Live in an ______." },
        { w: "sidewalk", c: "äººè¡Œé“", s: "Walk on the ______." },
        { w: "side", c: "é‚Šï¼›é¢", s: "The other ______." },
        { w: "blind", c: "ç›²çš„", s: "Help the ______ man." },
        { w: "seat", c: "åº§ä½", s: "Take a ______." },
        { w: "beside", c: "åœ¨...æ—é‚Š", s: "Sit ______ me." },
        { w: "except", c: "é™¤äº†", s: "Everyone ______ me." },
        { w: "perhaps", c: "æˆ–è¨±", s: "______ it will rain." },
        { w: "joke", c: "ç©ç¬‘", s: "Tell a ______." },
        { w: "April Fools' Day", c: "æ„šäººç¯€", s: "It's ______." },
        { w: "present", c: "ç¦®ç‰©", s: "A birthday ______." },
        { w: "kiss", c: "å»", s: "Give a ______." },
        { w: "serious", c: "èªçœŸçš„", s: "Why so ______?" },
        { w: "lazy", c: "æ‡¶æƒ°çš„", s: "Don't be ______." },
        { w: "rich", c: "å¯Œæœ‰çš„", s: "A ______ man." },
        { w: "glad", c: "é«˜èˆˆçš„", s: "I am ______." },
        { w: "polite", c: "æœ‰ç¦®è²Œçš„", s: "Be ______ to others." },
        { w: "blank", c: "ç©ºç™½(çš„)", s: "Fill in the ______." },
        { w: "paper", c: "ç´™", s: "A piece of ______." },
        { w: "tape", c: "è† å¸¶", s: "Use ______ to stick." },
        { w: "rise", c: "å‡èµ·", s: "Sun ______s in east." },
        { w: "smoke", c: "ç…™", s: "Fire makes ______." },
        { w: "heat", c: "ç†±", s: "Feel the ______." },
        { w: "cover", c: "è¦†è“‹", s: "______ your mouth." },
        { w: "mud", c: "æ³¥åœŸ", s: "Shoes full of ______." },
        { w: "spell", c: "å’’èª", s: "Cast a ______." },
        { w: "lie", c: "èºº", s: "______ down." },
        { w: "ahead", c: "åœ¨å‰æ–¹", s: "Go ______." },
        { w: "somewhere", c: "æŸè™•", s: "It is ______ here." },
        { w: "draw", c: "ææ¬¾", s: "______ money." },
        { w: "used to", c: "éå»æ™‚å¸¸", s: "I ______ play here." },
        { w: "have bigger fish to fry", c: "æœ‰æ›´é‡è¦çš„äº‹", s: "I ______." }
    ];

    const TOTAL_QUESTIONS = 55;
    const QUESTIONS_PER_PAGE = 5;
    
    let currentQuizData = [];
    let currentPage = 1;
    let totalPages = 1;

    // æ´—ç‰Œ
    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        while (currentIndex != 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
        }
        return array;
    }

    // åˆå§‹åŒ–
    function initQuiz() {
        let pool = shuffle([...rawData]);
        // ç¢ºä¿é¡Œç›®è¶³å¤ 
        while (pool.length < TOTAL_QUESTIONS) {
            pool = pool.concat(shuffle([...rawData]));
        }
        pool = pool.slice(0, TOTAL_QUESTIONS);

        currentQuizData = pool.map((item, index) => {
            let type = Math.floor(Math.random() * 3);
            if (!item.s) type = Math.floor(Math.random() * 2);

            let qObj = { 
                id: index + 1, 
                correct: null, 
                options: [], 
                typeText: "", 
                questionText: "",
                wordPair: `${item.w} = ${item.c}` // ç”¨æ–¼éŒ¯é¡Œè¼¸å‡º
            };
            
            let distractors = [];
            while(distractors.length < 3) {
                let r = rawData[Math.floor(Math.random() * rawData.length)];
                if (r.w !== item.w && !distractors.includes(r)) distractors.push(r);
            }

            if (type === 0) { 
                qObj.typeText = "ä¸­é¸è‹±";
                qObj.questionText = `<b>${item.c}</b> çš„è‹±æ–‡æ˜¯ï¼Ÿ`;
                qObj.correct = item.w;
                qObj.options = shuffle([item.w, ...distractors.map(d => d.w)]);
            } else if (type === 1) { 
                qObj.typeText = "è‹±é¸ä¸­";
                qObj.questionText = `<b>${item.w}</b> çš„ä¸­æ–‡æ˜¯ï¼Ÿ`;
                qObj.correct = item.c;
                qObj.options = shuffle([item.c, ...distractors.map(d => d.c)]);
            } else { 
                qObj.typeText = "å¡«ç©º";
                let mask = item.s.replace(new RegExp(item.w, "ig"), "______");
                if(item.w.includes(" ")) mask = item.s.replace(item.w, "______");
                qObj.questionText = `${mask} <br><small style='color:#aaa; font-weight:normal;'>(${item.c})</small>`;
                qObj.correct = item.w;
                qObj.options = shuffle([item.w, ...distractors.map(d => d.w)]);
            }
            return qObj;
        });

        totalPages = Math.ceil(TOTAL_QUESTIONS / QUESTIONS_PER_PAGE);
        renderPages();
        updateUI();
    }

    function renderPages() {
        const container = document.getElementById('quiz-pages');
        let html = "";
        for (let p = 1; p <= totalPages; p++) {
            let active = (p === 1) ? "active" : "";
            html += `<div class="page ${active}" id="page-${p}">`;
            let start = (p - 1) * QUESTIONS_PER_PAGE;
            let end = Math.min(start + QUESTIONS_PER_PAGE, currentQuizData.length);
            for (let i = start; i < end; i++) {
                let q = currentQuizData[i];
                html += `
                <div class="question-card" id="q-${q.id}" data-correct="${q.correct}" data-pair="${q.wordPair}">
                    <div class="q-type">${q.typeText}</div>
                    <span class="q-text">${q.id}. ${q.questionText}</span>
                    <div class="options">
                        ${q.options.map(opt => `<label><input type="radio" name="q${q.id}" value="${opt}"> ${opt}</label>`).join('')}
                    </div>
                    <div class="answer-key">ğŸ’¡ æ­£è§£: ${q.correct}</div>
                </div>`;
            }
            html += `</div>`;
        }
        container.innerHTML = html;
        document.getElementById('qCount').innerText = `å·²å¯«: 0/${TOTAL_QUESTIONS}`;
    }

    function nextPage() {
        document.getElementById(`page-${currentPage}`).classList.remove('active');
        currentPage++;
        document.getElementById(`page-${currentPage}`).classList.add('active');
        window.scrollTo(0, 0);
        updateUI();
    }

    function updateUI() {
        let pct = (currentPage / totalPages) * 100;
        document.getElementById('progressBar').style.width = `${pct}%`;
        document.getElementById('pageIndicator').innerText = `Page ${currentPage} / ${totalPages}`;

        const btnNext = document.getElementById('btnNext');
        const btnSubmit = document.getElementById('btnSubmit');

        if (currentPage === totalPages) {
            btnNext.style.display = 'none';
            btnSubmit.style.display = 'block';
        } else {
            btnNext.style.display = 'block';
            btnSubmit.style.display = 'none';
        }
        
        const ans = document.querySelectorAll('input[type="radio"]:checked').length;
        document.getElementById('qCount').innerText = `å·²å¯«: ${ans}/${TOTAL_QUESTIONS}`;
    }

    document.addEventListener('change', (e) => { if(e.target.type === 'radio') updateUI(); });

    function submitQuiz() {
        let correctCount = 0;
        let wrongItems = []; // å„²å­˜éŒ¯é¡Œ

        document.querySelectorAll('.page').forEach(p => p.style.display = 'block');
        document.querySelector('.nav-buttons').style.display = 'none';
        document.querySelector('.progress-container').style.display = 'none';
        document.querySelector('header').style.display = 'none';

        currentQuizData.forEach(q => {
            const card = document.getElementById(`q-${q.id}`);
            const sel = document.querySelector(`input[name="q${q.id}"]:checked`);
            const key = card.querySelector('.answer-key');
            const wordPair = card.getAttribute('data-pair'); // å–å¾—å–®å­—å°ç…§ (apple=è˜‹æœ)
            
            card.querySelectorAll('label').forEach(l => l.classList.remove('correct', 'wrong'));
            
            if (sel) {
                if (sel.value === q.correct) {
                    correctCount++;
                    sel.parentElement.classList.add('correct');
                } else {
                    sel.parentElement.classList.add('wrong');
                    // éŒ¯äº†ï¼ŒåŠ å…¥éŒ¯é¡Œåˆ—è¡¨
                    wrongItems.push(wordPair);
                    // æ¨™ç¤ºæ­£è§£
                    card.querySelectorAll('input').forEach(i => { if(i.value === q.correct) i.parentElement.classList.add('correct'); });
                }
            } else {
                card.style.border = "2px dashed #ff6b81"; // æ²’å¯«
                key.style.display = 'block';
                wrongItems.push(wordPair); // æ²’å¯«ä¹Ÿç®—éŒ¯
            }
            if (!sel || sel.value !== q.correct) key.style.display = 'block';
        });

        let finalScore = Math.round((correctCount / TOTAL_QUESTIONS) * 100);
        
        const today = new Date();
        const dateStr = `${today.getFullYear()}/${today.getMonth()+1}/${today.getDate()}`;

        const resultArea = document.getElementById('result-area');
        resultArea.style.display = 'block';
        document.getElementById('score-text').innerText = finalScore;
        document.getElementById('comment').innerText = `ç­”å°ï¼š${correctCount} / ${TOTAL_QUESTIONS} é¡Œ`;
        document.getElementById('date-display').innerText = `æ¸¬é©—æ—¥æœŸï¼š${dateStr}`;

        // è¨­å®š 1ï¼šç¹³äº¤æˆç¸¾æŒ‰éˆ•
        const shareTextScore = `ã€Unit 5&6 æˆç¸¾å›å ±ã€‘\næ—¥æœŸï¼š${dateStr}\nå¾—åˆ†ï¼š${finalScore} åˆ†\nç­”å°ï¼š${correctCount} / ${TOTAL_QUESTIONS}\nè€å¸«ï¼Œé€™æ˜¯æˆ‘ä»Šå¤©çš„ç·´ç¿’æˆç¸¾ï¼`;
        document.getElementById('line-share-btn').href = `https://line.me/R/msg/text/?${encodeURIComponent(shareTextScore)}`;

        // è¨­å®š 2ï¼šéŒ¯é¡ŒåŒ¯å‡ºæŒ‰éˆ• (å¦‚æœæœ‰éŒ¯é¡Œæ‰é¡¯ç¤º)
        const wrongBtn = document.getElementById('wrong-share-btn');
        if (wrongItems.length > 0) {
            wrongBtn.style.display = 'flex';
            // æ•´ç†éŒ¯é¡Œæ–‡å­—
            // æ ¼å¼ï¼š
            // ã€éŒ¯é¡Œè¨‚æ­£ã€‘
            // 1. word = ä¸­æ–‡
            // 2. word = ä¸­æ–‡
            let wrongTextList = `ã€éŒ¯é¡Œè¨‚æ­£ã€‘(${dateStr})\nè«‹å°‡é€™äº›å–®å­—æŠ„åœ¨ç­†è¨˜æœ¬ä¸Šï¼š\n`;
            wrongItems.forEach((item, index) => {
                wrongTextList += `${index + 1}. ${item}\n`;
            });
            
            wrongBtn.href = `https://line.me/R/msg/text/?${encodeURIComponent(wrongTextList)}`;
        } else {
            wrongBtn.style.display = 'none'; // å…¨å°å°±ä¸ç”¨é¡¯ç¤º
            document.getElementById('comment').innerText += " (å¤ªå¼·äº†ï¼å…¨å°ï¼)";
        }

        window.scrollTo(0, 0);
    }

    // å•Ÿå‹•
    initQuiz();
</script>

</body>
</html>